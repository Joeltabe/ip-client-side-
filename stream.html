<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Custom Streaming Platform</title>
<link rel="stylesheet" href="./assets/css/forms.css">
</head>
<body>
<div class="container">
  <h1>Welcome to Our Streaming Platform</h1>
  <div class="video-container">
    <video id="video-player" controls>
      <!-- Video source will be dynamically loaded here -->
    </video>
  </div>
  <div class="video-list">
    <h2>Latest Videos</h2>
    <div id="video-list-container">
      <!-- Video list will be dynamically loaded here -->
    </div>
  </div>
</div>

<script>
    // JavaScript for the streaming platform

// Function to load the latest videos
async function loadVideoList() {
  try {
    // Make a GET request to fetch the latest videos
    const response = await fetch('https://ip-server-side.onrender.com/api/videos/videos');
    if (response.ok) {
      const videos = await response.json();
      const videoListContainer = document.getElementById('video-list-container');
      // Clear previous video list
      videoListContainer.innerHTML = '';
      // Populate the video list
      videos.forEach(video => {
        const videoElement = document.createElement('div');
        videoElement.innerHTML = `
          <div>
            <h3>${video.title}</h3>
            <video class="list-video" controls data-src="${video.videoUrl}">
              <source src="${video.videoUrl}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        `;
        videoListContainer.appendChild(videoElement);
      });

      // Add event listener to each video in the list
      const listVideos = document.querySelectorAll('.list-video');
      listVideos.forEach(video => {
        video.addEventListener('click', function() {
          const videoPlayer = document.getElementById('video-player');
          const videoUrl = this.getAttribute('data-src');
          videoPlayer.src = videoUrl;
          videoPlayer.play();
        });
      });
    } else {
      console.error('Error fetching latest videos:', response.statusText);
    }
  } catch (error) {
    console.error('Error fetching latest videos:', error);
  }
}

// Load the latest videos when the page loads
window.addEventListener('DOMContentLoaded', loadVideoList);

</script>
</body>
</html>
